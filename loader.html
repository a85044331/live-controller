<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>直播代理加载器</title>
  <style>
    html, body, iframe { margin: 0; padding: 0; width: 100%; height: 100%; border: none; }
  </style>
</head>
<body>
  <iframe id="liveFrame" sandbox="allow-same-origin allow-scripts allow-forms" allow="autoplay"></iframe>

  <script>
    const urlParams = new URLSearchParams(location.search);
    const targetUrl = urlParams.get('url');

    if (targetUrl) {
      document.getElementById('liveFrame').src = targetUrl;
      window.parent?.postMessage({ type: 'popupReady', title: document.title, url: targetUrl }, '*');
    }

    window.addEventListener('beforeunload', () => {
      window.parent?.postMessage({ type: 'popupClosed', title: document.title, url: targetUrl }, '*');
    });
  </script>
</body>
</html>
